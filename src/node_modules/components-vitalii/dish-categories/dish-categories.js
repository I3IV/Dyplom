import React from 'react';
import PropTypes from 'prop-types';
import AppBar from '@material-ui/core/AppBar';
import Tabs from '@material-ui/core/Tabs';
import Tab from '@material-ui/core/Tab';
import Typography from '@material-ui/core/Typography';
import GridList from 'components/grid-list';
import DishListItem from 'components/grid-list-item-dish';
import {
  dishCategoriesSelectItems,
  getDishesByCategoryId
} from "api";
import './dish-categories.css';

function TabContainer(props) {
  return (
    <Typography component="div" style={{ padding: 8 * 3 }}>
      {props.children}
    </Typography>
  );
}

TabContainer.propTypes = {
  children: PropTypes.node.isRequired,
};

export default class SimpleTabs extends React.Component {
  state = {
    value: 0,
  };

  handleChange = (event, value) => {
    this.setState({ value });
  };

  renderTabs = (categories) => {
    if(!categories) return [];
    return (
      categories.map( ({value, label}) => {
         return (
           <Tab
             key = {value}
             label = {label}
             />
          );
       }
     )
    );
  }

  render() {
    const { value } = this.state;
    const { restaurant_id } = this.props;
    const categories = dishCategoriesSelectItems(restaurant_id);
    const dishes = categories[value] ? getDishesByCategoryId(categories[value].value) : [];

    return (
      <div className = "categories">
        <AppBar position="static">
          <Tabs value={value} onChange={this.handleChange} >
            {
              this.renderTabs(categories)
            }
          </Tabs>
        </AppBar>
        <TabContainer>
          <GridList data={dishes} GridListItem={DishListItem} onDishAddClick = {this.props.onDishAddClick}/>
        </TabContainer>
      </div>
    );
  }
}
