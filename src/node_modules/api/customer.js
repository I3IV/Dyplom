import client from "feathers/client";
import {authStore} from "store";

export const getLoggedInUser = () =>
    client
        .authenticate()
        .then(response => {
            return client.passport.verifyJWT(response.accessToken);
        })
        .then(payload => {
            return client.service("customers").get(payload.userId);
        })
        .catch(() => undefined);

export const updateUser = user => {
    client.service("customers").patch(client.get("user").id, user);
    authStore.setUser(user);
}