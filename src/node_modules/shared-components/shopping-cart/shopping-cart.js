import IconButton from "@material-ui/core/es/IconButton/IconButton";
import React, { Component, Fragment } from "react";
import Collapse from "@material-ui/core/Collapse";
import DishesList from "components/pages/schedule-items-page/schedule-item-dishes-list";
import Button from "@material-ui/core/Button";
import ShoppingCartImage from "@material-ui/icons/ShoppingCart";
import Badge from "@material-ui/core/es/Badge/Badge";
import "./shopping-cart.css"
import {cartStore} from 'store'
import {observer} from "mobx-react";

class SelectControl extends Component {
    render() {
    const cart = cartStore.cart
      ? JSON.parse(cartStore.cart)
      : undefined;
    if(cart){
        cartStore.setLength(cart.dishes.length)
    }
    return (
      <Fragment>
        <IconButton onClick={() => cartStore.expand()}>
          <Badge badgeContent={cartStore.length} color="primary">
            <ShoppingCartImage />
          </Badge>
        </IconButton>
        <div className="front">
          <Collapse in={cartStore.expanded} timeout="auto" unmountOnExit>
            <div className="front-dishes-list">
              <DishesList items={cart ? cart.dishes : []} />
              <Button
                onClick={this.props.handleApply}
                fullWidth
                color="primary"
                variant="contained"
              >
                Proceed To Checkout
              </Button>
            </div>
          </Collapse>
        </div>
      </Fragment>
    );
  }
}

export default (observer(SelectControl));