import React, { Fragment, Component } from 'react';

import Header from 'components/shared-components/header';
import GridList from 'components/grid-list';
import SearchPanel from 'components/search-panel';
import RestaurantFilter from 'components/restaurant-filter';

import DishListItem from 'components/grid-list-item-dish'

import './restaurant-page.css'

import dishes from 'api/mock-dishes';

const navItems = [
  {label: 'Restaurants', link: 'restaurants'},
  {label: 'Login', link: 'login' },
  {label: 'Registration', link: 'registration'}
];

export default class RestaurantPage extends Component{

  state = {
    dishes: dishes,
    term: ''
  }

  onSearchChange = (term) => {
  this.setState({ term });
};

search(dishes, term) {
  if(term.length === 0) {
    return dishes;
  }
  return dishes.filter( (r) => {
    return r.name
           .toLowerCase()
           .indexOf(term.toLowerCase()) > -1
  })
}

  render(){
    const { dishes, term } = this.state;

    const visibleItems = () => this.search(dishes, term);

    const DataToShow = visibleItems().length !== 0 ? () => <GridList data={ visibleItems() } GridListItem = {DishListItem}/>
                                                   : () => <span className="message">No results that match your search</span>;
    return (
      <Fragment>
        <Header navItems={ navItems } />
        <div className='rest-page-content'>
          <div className="filter-bar">
            <div className="search-bar">
              <SearchPanel placeholder="Search dishes" onSearchChange = {this.onSearchChange}/>
            </div>
              <RestaurantFilter />
          </div>
        </div>
        <DataToShow />
      </Fragment>
    )
  };
}
