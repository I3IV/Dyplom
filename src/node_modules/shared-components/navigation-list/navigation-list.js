import React from "react";
import "./navigation-list.css";
import NavigationListItem from "../navigation-list-item";
import Timeline from "@material-ui/icons/CalendarToday";
import IconButton from "@material-ui/core/es/IconButton/IconButton";
import Badge from "@material-ui/core/es/Badge/Badge";
import { getEventsNumber } from "api";
import { Link } from "react-router-dom";
import Spinner from "shared-components/spinner";
import ShoppingCart from "shared-components/shopping-cart"
import {authStore} from "store";
import {calendarStore} from "store";
import {observer} from "mobx-react";

class Header extends React.Component {
  componentWillMount() {
    if (authStore.isAuthenticated)
      getEventsNumber().then(response => {
            calendarStore.setBadge(response);
          }
      );
  }

  render() {
    const navItemsGuest = [
      { label: "Sign in", link: "/login" },
      { label: "Sign up", link: "/registration" }
    ];

    const navItemsSignedIn = [{ label: "Account", link: "/account" }];

    const navItems = authStore.isAuthenticated
      ? navItemsSignedIn
      : navItemsGuest;
    return (
      <div className="navigation-list">
        <ShoppingCart />
        {authStore.isAuthenticated && (
          <Link to="/scheduler">
            <IconButton>
              <Badge badgeContent={calendarStore.badge} color="primary">
                <Timeline />
              </Badge>
            </IconButton>
          </Link>
        )}
        <ul>
          {navItems.map(item => {
            return <NavigationListItem item={item} key={item.label} />;
          })}
        </ul>
      </div>
    );
  }
}

export default observer(Header)