{"ast":null,"code":"import _defineProperty from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"H:\\\\I3IV\\\\Dyplom\\\\src\\\\node_modules\\\\components\\\\pages\\\\dish-page\\\\dish-side-page\\\\dish-side-page.js\";\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { withStyles, MuiThemeProvider } from \"@material-ui/core/styles\";\nimport Divider from \"@material-ui/core/Divider\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport RemoveIcon from \"@material-ui/icons/Remove\";\nimport RadioSelect from \"shared-components/radio-select\";\nimport ProductsList from \"shared-components/products-list\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Typography from \"@material-ui/core/Typography\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Button from \"@material-ui/core/Button\";\nimport { productsSelectItems } from \"api\";\nimport styles from \"./styles\";\nimport theme, { defaultTheme } from \"./themes\";\nvar formatter = new Intl.NumberFormat(\"en-US\", {\n  style: \"currency\",\n  currency: \"USD\",\n  minimumFractionDigits: 2\n});\n\nvar DishSidePage =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(DishSidePage, _React$Component);\n\n  function DishSidePage() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, DishSidePage);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(DishSidePage)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      products: [],\n      count: 1\n    };\n\n    _this.handleApply = function () {\n      if (!localStorage.getItem(\"cart\")) {\n        localStorage.setItem(\"cart\", JSON.stringify({\n          dishes: [],\n          totalPrice: 0\n        }));\n      }\n\n      var localStorageState = JSON.parse(localStorage.getItem(\"cart\"));\n      var dishes = localStorageState.dishes,\n          totalPrice = localStorageState.totalPrice;\n      var _this$state = _this.state,\n          dish = _this$state.dish,\n          count = _this$state.count,\n          sizes = _this$state.sizes,\n          size_id = _this$state.size_id;\n      var dishSize = sizes.find(function (size) {\n        return size.id == size_id;\n      });\n      var oldDishIdx = dishes.findIndex(function (d) {\n        return d.id === dishSize.DishInMenuId;\n      });\n      var oldDish = dishes[oldDishIdx];\n      var dishPrice = dishSize.price * count;\n      var newDish = !oldDish ? _objectSpread({}, dish, {\n        id: dishSize.DishInMenuId,\n        name: dish.Name,\n        size_id: size_id,\n        count: count,\n        price: dishPrice\n      }) : _objectSpread({}, oldDish, {\n        count: oldDish.count + 1\n      });\n      var newDishes = oldDish ? _toConsumableArray(dishes.slice(0, oldDishIdx)).concat([newDish], _toConsumableArray(dishes.slice(oldDishIdx + 1))) : _toConsumableArray(dishes).concat([newDish]);\n      var newCart = {\n        dishes: newDishes,\n        totalPrice: totalPrice + dishPrice\n      };\n      localStorage.setItem(\"cart\", JSON.stringify(newCart));\n\n      _this.props.handleApply();\n    };\n\n    _this.onDishSizeChange = function (size_id) {\n      _this.setState({\n        size_id: size_id\n      });\n    };\n\n    _this.onProductChange = function (product_id) {\n      var products = _this.state.products;\n\n      var changedProducts = _this.toggleProperty(products, product_id, \"checked\");\n\n      _this.setState({\n        products: changedProducts\n      });\n    };\n\n    _this.handleChange = function (name) {\n      return function (event) {\n        _this.setState(_defineProperty({}, name, event.target.value));\n      };\n    };\n\n    _this.onDishUp = function () {\n      _this.setState({\n        count: _this.state.count + 1\n      });\n    };\n\n    _this.onDishDown = function () {\n      if (_this.state.count - 1 >= 1) {\n        _this.setState({\n          count: _this.state.count - 1\n        });\n      }\n    };\n\n    _this.transformDishSizes = function (_sizes) {\n      return _sizes.map(function (size) {\n        return {\n          id: size.id,\n          name: size.DishSizeName,\n          price: size.price,\n          DishInMenuId: size.DishInMenuId\n        };\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(DishSidePage, [{\n    key: \"toggleProperty\",\n    value: function toggleProperty(arr, id, propName) {\n      var idx = arr.findIndex(function (el) {\n        return el.value === id;\n      });\n      var oldItem = arr[idx];\n\n      var newItem = _objectSpread({}, oldItem, _defineProperty({}, propName, !oldItem[propName]));\n\n      return _toConsumableArray(arr.slice(0, idx)).concat([newItem], _toConsumableArray(arr.slice(idx + 1)));\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      if (nextProps.dishToShow.id !== this.state.id) {\n        var _nextProps$dishToShow = nextProps.dishToShow,\n            Sizes = _nextProps$dishToShow.Sizes,\n            id = _nextProps$dishToShow.id;\n        this.setState({\n          dish: nextProps.dishToShow,\n          size_id: Sizes[0].id,\n          sizes: this.transformDishSizes(Sizes),\n          products: productsSelectItems(id).map(function (product) {\n            return _objectSpread({}, product, {\n              checked: true\n            });\n          })\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var classes = this.props.classes;\n      var _this$state2 = this.state,\n          count = _this$state2.count,\n          sizes = _this$state2.sizes,\n          size_id = _this$state2.size_id,\n          products = _this$state2.products,\n          dish = _this$state2.dish;\n      if (!dish) return \"\";\n      var id = dish.id,\n          Name = dish.Name,\n          Description = dish.Description;\n      var Price = sizes.find(function (size) {\n        return size.id == size_id;\n      }).price;\n      return React.createElement(\"div\", {\n        className: classes.list,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, React.createElement(MuiThemeProvider, {\n        theme: theme,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: classes.content,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: \"/images/dishes/\".concat(id, \".jpg\"),\n        alt: Name,\n        className: classes.dishImg,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: classes.topDesc,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, React.createElement(Typography, {\n        variant: \"h6\",\n        color: \"primary\",\n        gutterBottom: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, Name), React.createElement(Typography, {\n        variant: \"body2\",\n        color: \"secondary\",\n        gutterBottom: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, Description)), React.createElement(Divider, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }), React.createElement(MuiThemeProvider, {\n        theme: defaultTheme,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, React.createElement(Typography, {\n        className: classes.text,\n        variant: \"h6\",\n        color: \"textSecondary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, \"Select size\"), size_id && React.createElement(RadioSelect, {\n        items: sizes,\n        selected: size_id,\n        onChange: this.onDishSizeChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }), React.createElement(Divider, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      }), React.createElement(Typography, {\n        className: classes.text,\n        variant: \"h6\",\n        color: \"textSecondary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, \"Select products\"), products && React.createElement(ProductsList, {\n        items: products,\n        onProductChange: this.onProductChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }), React.createElement(Divider, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }), React.createElement(Typography, {\n        className: classes.text,\n        variant: \"h6\",\n        color: \"textSecondary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, \"Comment\")), React.createElement(TextField, {\n        id: \"filled-textarea\",\n        placeholder: \"Enter your comment\",\n        multiline: true,\n        rows: \"4\",\n        className: classes.textField,\n        margin: \"normal\",\n        variant: \"filled\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }), React.createElement(Divider, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: classes.bottomPanel,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: classes.flexRow,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"\".concat(classes.flexRow, \" \").concat(classes.flexPrice),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      }, React.createElement(IconButton, {\n        className: classes.iconButton,\n        \"aria-label\": \"Remove\",\n        onClick: this.onDishDown,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }, React.createElement(RemoveIcon, {\n        fontSize: \"small\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        },\n        __self: this\n      })), React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, count), React.createElement(IconButton, {\n        className: classes.iconButton,\n        \"aria-label\": \"Add\",\n        onClick: this.onDishUp,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }, React.createElement(AddIcon, {\n        fontSize: \"small\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }))), React.createElement(Typography, {\n        className: classes.price,\n        variant: \"h6\",\n        color: \"textPrimary\",\n        align: \"center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }, formatter.format(count * Price))), React.createElement(MuiThemeProvider, {\n        theme: defaultTheme,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233\n        },\n        __self: this\n      }, React.createElement(Button, {\n        onClick: this.handleApply,\n        color: \"secondary\",\n        variant: \"outlined\",\n        className: classes.button,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }, \"Add to cart\")))));\n    }\n  }]);\n\n  return DishSidePage;\n}(React.Component);\n\nDishSidePage.propTypes = {\n  classes: PropTypes.object.isRequired\n};\nexport default withStyles(styles)(DishSidePage);","map":{"version":3,"sources":["H:\\I3IV\\Dyplom\\src\\node_modules\\components\\pages\\dish-page\\dish-side-page\\dish-side-page.js"],"names":["React","PropTypes","withStyles","MuiThemeProvider","Divider","AddIcon","RemoveIcon","RadioSelect","ProductsList","TextField","Typography","IconButton","Button","productsSelectItems","styles","theme","defaultTheme","formatter","Intl","NumberFormat","style","currency","minimumFractionDigits","DishSidePage","state","products","count","handleApply","localStorage","getItem","setItem","JSON","stringify","dishes","totalPrice","localStorageState","parse","dish","sizes","size_id","dishSize","find","size","id","oldDishIdx","findIndex","d","DishInMenuId","oldDish","dishPrice","price","newDish","name","Name","newDishes","slice","newCart","props","onDishSizeChange","setState","onProductChange","product_id","changedProducts","toggleProperty","handleChange","event","target","value","onDishUp","onDishDown","transformDishSizes","_sizes","map","DishSizeName","arr","propName","idx","el","oldItem","newItem","nextProps","dishToShow","Sizes","product","checked","classes","Description","Price","list","content","dishImg","topDesc","text","textField","bottomPanel","flexRow","flexPrice","iconButton","format","button","Component","propTypes","object","isRequired"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { withStyles, MuiThemeProvider } from \"@material-ui/core/styles\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport RemoveIcon from \"@material-ui/icons/Remove\";\r\nimport RadioSelect from \"shared-components/radio-select\";\r\nimport ProductsList from \"shared-components/products-list\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport { productsSelectItems } from \"api\";\r\nimport styles from \"./styles\";\r\nimport theme, { defaultTheme } from \"./themes\";\r\n\r\nconst formatter = new Intl.NumberFormat(\"en-US\", {\r\n  style: \"currency\",\r\n  currency: \"USD\",\r\n  minimumFractionDigits: 2\r\n});\r\nclass DishSidePage extends React.Component {\r\n  state = {\r\n    products: [],\r\n    count: 1\r\n  };\r\n  handleApply = () => {\r\n    if (!localStorage.getItem(\"cart\")) {\r\n      localStorage.setItem(\r\n        \"cart\",\r\n        JSON.stringify({ dishes: [], totalPrice: 0 })\r\n      );\r\n    }\r\n    const localStorageState = JSON.parse(localStorage.getItem(\"cart\"));\r\n    const { dishes, totalPrice } = localStorageState;\r\n    const { dish, count, sizes, size_id } = this.state;\r\n    const dishSize = sizes.find(size => size.id == size_id);\r\n    const oldDishIdx = dishes.findIndex(d => d.id === dishSize.DishInMenuId);\r\n    const oldDish = dishes[oldDishIdx];\r\n    const dishPrice = dishSize.price * count;\r\n    const newDish = !oldDish\r\n      ? {\r\n          ...dish,\r\n          id: dishSize.DishInMenuId,\r\n          name: dish.Name,\r\n          size_id,\r\n          count,\r\n          price: dishPrice\r\n        }\r\n      : {\r\n          ...oldDish,\r\n          count: oldDish.count + 1\r\n        };\r\n    const newDishes = oldDish\r\n      ? [\r\n          ...dishes.slice(0, oldDishIdx),\r\n          newDish,\r\n          ...dishes.slice(oldDishIdx + 1)\r\n        ]\r\n      : [...dishes, newDish];\r\n    const newCart = {\r\n      dishes: newDishes,\r\n      totalPrice: totalPrice + dishPrice\r\n    };\r\n    localStorage.setItem(\"cart\", JSON.stringify(newCart));\r\n    this.props.handleApply();\r\n  };\r\n  toggleProperty(arr, id, propName) {\r\n    const idx = arr.findIndex(el => el.value === id);\r\n    const oldItem = arr[idx];\r\n    const newItem = { ...oldItem, [propName]: !oldItem[propName] };\r\n\r\n    return [...arr.slice(0, idx), newItem, ...arr.slice(idx + 1)];\r\n  }\r\n  onDishSizeChange = size_id => {\r\n    this.setState({\r\n      size_id\r\n    });\r\n  };\r\n  onProductChange = product_id => {\r\n    const { products } = this.state;\r\n    const changedProducts = this.toggleProperty(\r\n      products,\r\n      product_id,\r\n      \"checked\"\r\n    );\r\n    this.setState({\r\n      products: changedProducts\r\n    });\r\n  };\r\n  handleChange = name => event => {\r\n    this.setState({\r\n      [name]: event.target.value\r\n    });\r\n  };\r\n  onDishUp = () => {\r\n    this.setState({\r\n      count: this.state.count + 1\r\n    });\r\n  };\r\n  onDishDown = () => {\r\n    if (this.state.count - 1 >= 1) {\r\n      this.setState({\r\n        count: this.state.count - 1\r\n      });\r\n    }\r\n  };\r\n  transformDishSizes = _sizes => {\r\n    return _sizes.map(size => ({\r\n      id: size.id,\r\n      name: size.DishSizeName,\r\n      price: size.price,\r\n      DishInMenuId: size.DishInMenuId\r\n    }));\r\n  };\r\n  componentWillReceiveProps(nextProps) {\r\n    if (nextProps.dishToShow.id !== this.state.id) {\r\n      const { Sizes, id } = nextProps.dishToShow;\r\n      this.setState({\r\n        dish: nextProps.dishToShow,\r\n        size_id: Sizes[0].id,\r\n        sizes: this.transformDishSizes(Sizes),\r\n        products: productsSelectItems(id).map(product => ({\r\n          ...product,\r\n          checked: true\r\n        }))\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { classes } = this.props;\r\n    const { count, sizes, size_id, products, dish } = this.state;\r\n    if (!dish) return \"\";\r\n    const { id, Name, Description } = dish;\r\n    const Price = sizes.find(size => size.id == size_id).price;\r\n    return (\r\n      <div className={classes.list}>\r\n        <MuiThemeProvider theme={theme}>\r\n          <div className={classes.content}>\r\n            <img\r\n              src={`/images/dishes/${id}.jpg`}\r\n              alt={Name}\r\n              className={classes.dishImg}\r\n            />\r\n\r\n            <div className={classes.topDesc}>\r\n              <Typography variant=\"h6\" color=\"primary\" gutterBottom>\r\n                {Name}\r\n              </Typography>\r\n              <Typography variant=\"body2\" color=\"secondary\" gutterBottom>\r\n                {Description}\r\n              </Typography>\r\n            </div>\r\n            <Divider />\r\n            <MuiThemeProvider theme={defaultTheme}>\r\n              <Typography\r\n                className={classes.text}\r\n                variant=\"h6\"\r\n                color=\"textSecondary\"\r\n              >\r\n                Select size\r\n              </Typography>\r\n              {size_id && (\r\n                <RadioSelect\r\n                  items={sizes}\r\n                  selected={size_id}\r\n                  onChange={this.onDishSizeChange}\r\n                />\r\n              )}\r\n              <Divider />\r\n              <Typography\r\n                className={classes.text}\r\n                variant=\"h6\"\r\n                color=\"textSecondary\"\r\n              >\r\n                Select products\r\n              </Typography>\r\n              {products && (\r\n                <ProductsList\r\n                  items={products}\r\n                  onProductChange={this.onProductChange}\r\n                />\r\n              )}\r\n              <Divider />\r\n              <Typography\r\n                className={classes.text}\r\n                variant=\"h6\"\r\n                color=\"textSecondary\"\r\n              >\r\n                Comment\r\n              </Typography>\r\n            </MuiThemeProvider>\r\n            <TextField\r\n              id=\"filled-textarea\"\r\n              placeholder=\"Enter your comment\"\r\n              multiline\r\n              rows=\"4\"\r\n              className={classes.textField}\r\n              margin=\"normal\"\r\n              variant=\"filled\"\r\n            />\r\n            <Divider />\r\n          </div>\r\n          <div className={classes.bottomPanel}>\r\n            <div className={classes.flexRow}>\r\n              <div className={`${classes.flexRow} ${classes.flexPrice}`}>\r\n                <IconButton\r\n                  className={classes.iconButton}\r\n                  aria-label=\"Remove\"\r\n                  onClick={this.onDishDown}\r\n                >\r\n                  <RemoveIcon fontSize=\"small\" />\r\n                </IconButton>\r\n                <span>{count}</span>\r\n                <IconButton\r\n                  className={classes.iconButton}\r\n                  aria-label=\"Add\"\r\n                  onClick={this.onDishUp}\r\n                >\r\n                  <AddIcon fontSize=\"small\" />\r\n                </IconButton>\r\n              </div>\r\n              <Typography\r\n                className={classes.price}\r\n                variant=\"h6\"\r\n                color=\"textPrimary\"\r\n                align=\"center\"\r\n              >\r\n                {formatter.format(count * Price)}\r\n              </Typography>\r\n            </div>\r\n            <MuiThemeProvider theme={defaultTheme}>\r\n              <Button\r\n                onClick={this.handleApply}\r\n                color=\"secondary\"\r\n                variant=\"outlined\"\r\n                className={classes.button}\r\n              >\r\n                Add to cart\r\n              </Button>\r\n            </MuiThemeProvider>\r\n          </div>\r\n        </MuiThemeProvider>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nDishSidePage.propTypes = {\r\n  classes: PropTypes.object.isRequired\r\n};\r\n\r\nexport default withStyles(styles)(DishSidePage);\r\n"]},"metadata":{},"sourceType":"module"}