{"ast":null,"code":"import _regeneratorRuntime from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"H:\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"H:\\\\I3IV\\\\Dyplom\\\\src\\\\node_modules\\\\components\\\\pages\\\\schedule-items-page\\\\schedule-items-page.js\";\nimport React, { Component } from \"react\";\nimport BigCalendar from \"react-big-calendar\";\nimport \"react-big-calendar/lib/css/react-big-calendar.css\";\nimport moment from \"moment\";\nimport ScheduleDialog from \"./schedule-dialog\";\nimport { createEvent, getEvents, deleteEvent } from \"api\";\nimport Spinner from \"shared-components/spinner\";\nimport { calendarStore } from \"store\";\nvar localizer = BigCalendar.momentLocalizer(moment);\nvar events = [];\n\nvar MyCalendar =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(MyCalendar, _Component);\n\n  function MyCalendar() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MyCalendar);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MyCalendar)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      events: events,\n      selectedEvent: {},\n      dialogOpen: false,\n      editItem: false\n    };\n\n    _this.handleAddApply = function (event) {\n      console.log(\"EVENT TO POST\", event);\n\n      if (event.restaurant_id) {\n        createEvent(event).then(function (si) {\n          _this.setState({\n            events: _toConsumableArray(_this.state.events).concat([_objectSpread({}, event, {\n              ScheduleItem_id: si.id\n            })]),\n            dialogOpen: false\n          });\n\n          getEvents().then(function (events) {\n            console.log(\"Got events\", events);\n            calendarStore.setBadge(events.length);\n\n            _this.setState({\n              events: events,\n              loading: false\n            });\n          });\n        });\n      }\n    };\n\n    _this.handleEditApply =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(newEvent) {\n        var oldEvents, idx;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                oldEvents = _this.state.events;\n                idx = oldEvents.findIndex(function (ev) {\n                  return ev.ScheduleItem_id === newEvent.ScheduleItem_id;\n                });\n\n                if (newEvent.restaurant_id) {\n                  if (newEvent.ScheduleItem_id) deleteEvent(newEvent.ScheduleItem_id).then(createEvent(newEvent).then(function (si) {\n                    _this.setState({\n                      events: _toConsumableArray(oldEvents.slice(0, idx)).concat([_objectSpread({}, newEvent, {\n                        ScheduleItem_id: si.id\n                      })], _toConsumableArray(oldEvents.slice(idx + 1))),\n                      dialogOpen: false\n                    });\n\n                    getEvents().then(function (events) {\n                      console.log(\"Got events\", events);\n                      calendarStore.setBadge(events.length);\n\n                      _this.setState({\n                        events: events,\n                        loading: false\n                      });\n                    });\n                  }));\n                }\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.handleDelete = function (_ref2) {\n      var start = _ref2.start,\n          end = _ref2.end,\n          ScheduleItem_id = _ref2.ScheduleItem_id;\n      var oldEvents = _this.state.events;\n      var idx = oldEvents.findIndex(function (ev) {\n        return ev.start === start && ev.end === end;\n      });\n\n      _this.setState({\n        events: _toConsumableArray(oldEvents.slice(0, idx)).concat(_toConsumableArray(oldEvents.slice(idx + 1)))\n      });\n\n      if (ScheduleItem_id) deleteEvent(ScheduleItem_id);\n    };\n\n    _this.handleSelectSlot = function (event) {\n      _this.setState({\n        dialogOpen: true,\n        editItem: false,\n        selectedEvent: _objectSpread({}, event, {\n          dishes: []\n        })\n      });\n    };\n\n    _this.handleSelectEvent = function (event) {\n      _this.setState({\n        dialogOpen: true,\n        editItem: true,\n        selectedEvent: event\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(MyCalendar, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.setState({\n        loading: true\n      });\n      getEvents().then(function (events) {\n        console.log(\"Got events\", events);\n        calendarStore.setBadge(events.length);\n\n        _this2.setState({\n          events: events,\n          loading: false\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render(props) {\n      if (this.state.loading) return React.createElement(Spinner, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      });\n      var handleApply = this.state.editItem ? this.handleEditApply : this.handleAddApply;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }, React.createElement(ScheduleDialog, {\n        dialogOpen: this.state.dialogOpen,\n        event: this.state.selectedEvent,\n        handleApply: handleApply,\n        handleDelete: this.handleDelete,\n        editItem: this.state.editItem,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }), React.createElement(BigCalendar, {\n        style: {\n          height: \"420px\",\n          marginLeft: \"5rem\",\n          marginRight: \"5rem\"\n        },\n        selectable: true,\n        popup: true,\n        showMultiDayTimes: true,\n        localizer: localizer,\n        events: this.state.events,\n        defaultView: BigCalendar.Views.WEEK,\n        scrollToTime: new Date(1970, 1, 1, 6),\n        onSelectSlot: this.handleSelectSlot,\n        onSelectEvent: this.handleSelectEvent,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return MyCalendar;\n}(Component);\n\nexport { MyCalendar as default };","map":{"version":3,"sources":["H:\\I3IV\\Dyplom\\src\\node_modules\\components\\pages\\schedule-items-page\\schedule-items-page.js"],"names":["React","Component","BigCalendar","moment","ScheduleDialog","createEvent","getEvents","deleteEvent","Spinner","calendarStore","localizer","momentLocalizer","events","MyCalendar","state","selectedEvent","dialogOpen","editItem","handleAddApply","event","console","log","restaurant_id","then","si","setState","ScheduleItem_id","id","setBadge","length","loading","handleEditApply","newEvent","oldEvents","idx","findIndex","ev","slice","handleDelete","start","end","handleSelectSlot","dishes","handleSelectEvent","props","handleApply","height","marginLeft","marginRight","Views","WEEK","Date"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport BigCalendar from \"react-big-calendar\";\r\nimport \"react-big-calendar/lib/css/react-big-calendar.css\";\r\nimport moment from \"moment\";\r\nimport ScheduleDialog from \"./schedule-dialog\";\r\nimport { createEvent, getEvents, deleteEvent } from \"api\";\r\nimport Spinner from \"shared-components/spinner\";\r\nimport {calendarStore} from \"store\";\r\n\r\nconst localizer = BigCalendar.momentLocalizer(moment);\r\nconst events = [];\r\n\r\nexport default class MyCalendar extends Component {\r\n  state = {\r\n    events,\r\n    selectedEvent: {},\r\n    dialogOpen: false,\r\n    editItem: false\r\n  };\r\n  componentDidMount() {\r\n    this.setState({ loading: true });\r\n    getEvents().then(events => {\r\n      console.log(\"Got events\", events);\r\n      calendarStore.setBadge(events.length);\r\n      this.setState({ events, loading: false });\r\n    });\r\n  }\r\n\r\n  handleAddApply = event => {\r\n    console.log(\"EVENT TO POST\", event);\r\n    if (event.restaurant_id) {\r\n      createEvent(event).then(si => {\r\n        this.setState({\r\n          events: [...this.state.events, { ...event, ScheduleItem_id: si.id }],\r\n          dialogOpen: false\r\n        });\r\n        getEvents().then(events => {\r\n          console.log(\"Got events\", events);\r\n          calendarStore.setBadge(events.length);\r\n          this.setState({ events, loading: false });\r\n        });\r\n      });\r\n    }\r\n  };\r\n  handleEditApply = async newEvent => {\r\n    const oldEvents = this.state.events;\r\n    const idx = oldEvents.findIndex(\r\n      ev => ev.ScheduleItem_id === newEvent.ScheduleItem_id\r\n    );\r\n\r\n    if (newEvent.restaurant_id) {\r\n      if (newEvent.ScheduleItem_id)\r\n        deleteEvent(newEvent.ScheduleItem_id).then(\r\n          createEvent(newEvent).then(si => {\r\n            this.setState({\r\n              events: [\r\n                ...oldEvents.slice(0, idx),\r\n                { ...newEvent, ScheduleItem_id: si.id },\r\n                ...oldEvents.slice(idx + 1)\r\n              ],\r\n              dialogOpen: false\r\n            });\r\n            getEvents().then(events => {\r\n              console.log(\"Got events\", events);\r\n              calendarStore.setBadge(events.length);\r\n              this.setState({ events, loading: false });\r\n            });\r\n          })\r\n        );\r\n    }\r\n  };\r\n\r\n  handleDelete = ({ start, end, ScheduleItem_id }) => {\r\n    const oldEvents = this.state.events;\r\n    const idx = oldEvents.findIndex(ev => ev.start === start && ev.end === end);\r\n    this.setState({\r\n      events: [...oldEvents.slice(0, idx), ...oldEvents.slice(idx + 1)]\r\n    });\r\n    if (ScheduleItem_id) deleteEvent(ScheduleItem_id);\r\n  };\r\n\r\n  handleSelectSlot = event => {\r\n    this.setState({\r\n      dialogOpen: true,\r\n      editItem: false,\r\n      selectedEvent: { ...event, dishes: [] }\r\n    });\r\n  };\r\n  handleSelectEvent = event => {\r\n    this.setState({\r\n      dialogOpen: true,\r\n      editItem: true,\r\n      selectedEvent: event\r\n    });\r\n  };\r\n\r\n  render(props) {\r\n    if (this.state.loading) return <Spinner />;\r\n    const handleApply = this.state.editItem\r\n      ? this.handleEditApply\r\n      : this.handleAddApply;\r\n    return (\r\n      <div>\r\n        <ScheduleDialog\r\n          dialogOpen={this.state.dialogOpen}\r\n          event={this.state.selectedEvent}\r\n          handleApply={handleApply}\r\n          handleDelete={this.handleDelete}\r\n          editItem={this.state.editItem}\r\n        />\r\n        <BigCalendar\r\n          style={{ height: \"420px\", marginLeft: \"5rem\", marginRight: \"5rem\" }}\r\n          selectable\r\n          popup\r\n          showMultiDayTimes\r\n          localizer={localizer}\r\n          events={this.state.events}\r\n          defaultView={BigCalendar.Views.WEEK}\r\n          scrollToTime={new Date(1970, 1, 1, 6)}\r\n          onSelectSlot={this.handleSelectSlot}\r\n          onSelectEvent={this.handleSelectEvent}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}