{"ast":null,"code":"import _defineProperty from \"D:\\\\Studia\\\\React\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"D:\\\\Studia\\\\React\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"D:\\\\Studia\\\\React\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"D:\\\\Studia\\\\React\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\Studia\\\\React\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"D:\\\\Studia\\\\React\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"D:\\\\Studia\\\\React\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"D:\\\\Studia\\\\React\\\\I3IV\\\\Dyplom\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"D:\\\\Studia\\\\React\\\\I3IV\\\\Dyplom\\\\src\\\\node_modules\\\\components\\\\schedule-dialog\\\\index.js\";\nimport React from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport SelectControl from \"components/select-control\";\nimport DishesList from \"components/schedule-item-dishes-list\";\nimport ProductsList from \"components/schedule-item-products-list\";\nimport RadioSelect from 'components/radio-select';\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport \"./schedule-dialog.css\";\nimport { restaurantsSelectItems, dishCategoriesSelectItems, dishesSelectItems, productsSelectItems, dishSizesSelectItems, addressesSelectItems, restaurantIdToName, seatsSelectItems, dishIdToName } from \"api\";\n\nvar ScheduleDialog =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ScheduleDialog, _React$Component);\n\n  function ScheduleDialog() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ScheduleDialog);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ScheduleDialog)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      open: false,\n      event: {\n        dishes: []\n      },\n      editMode: false\n    };\n    _this.deliveryLocations = [{\n      id: 1,\n      name: 'In restaurant'\n    }, {\n      id: 2,\n      name: 'Deliver to address'\n    }];\n\n    _this.increaseProperty = function (arr, id, propName) {\n      return _this.upDownProperty(arr, id, propName, true);\n    };\n\n    _this.decreseProperty = function (arr, id, propName) {\n      return _this.upDownProperty(arr, id, propName, false);\n    };\n\n    _this.onRestaurantChange = function (_ref) {\n      var value = _ref.value;\n\n      _this.setState({\n        event: _objectSpread({}, _this.state.event, {\n          title: restaurantIdToName(value),\n          restaurant_id: value,\n          category_id: 0,\n          selectedDish: undefined\n        })\n      });\n    };\n\n    _this.onDishCategoryChange = function (_ref2) {\n      var value = _ref2.value;\n\n      _this.setState({\n        event: _objectSpread({}, _this.state.event, {\n          category_id: value,\n          selectedDish: undefined\n        })\n      });\n    };\n\n    _this.onDishChange = function (_ref3) {\n      var value = _ref3.value;\n      var newSelectedDish = value ? {\n        id: value,\n        products: productsSelectItems(value).map(function (product) {\n          return _objectSpread({}, product, {\n            checked: true\n          });\n        }),\n        sizes: dishSizesSelectItems(value),\n        size_id: dishSizesSelectItems(value)[0].id\n      } : undefined;\n\n      _this.setState({\n        event: _objectSpread({}, _this.state.event, {\n          selectedDish: newSelectedDish\n        })\n      });\n    };\n\n    _this.onProductChange = function (product_id) {\n      var products = _this.state.event.selectedDish.products;\n\n      var changedProducts = _this.toggleProperty(products, product_id, \"checked\");\n\n      _this.setState({\n        event: _objectSpread({}, _this.state.event, {\n          selectedDish: _objectSpread({}, _this.state.event.selectedDish, {\n            products: changedProducts\n          })\n        })\n      });\n    };\n\n    _this.onDishSizeChange = function (size_id) {\n      _this.setState({\n        event: _objectSpread({}, _this.state.event, {\n          selectedDish: _objectSpread({}, _this.state.event.selectedDish, {\n            size_id: size_id\n          })\n        })\n      });\n    };\n\n    _this.onLocationChange = function (location_id) {\n      _this.setState({\n        event: _objectSpread({}, _this.state.event, {\n          location_id: location_id\n        })\n      });\n    };\n\n    _this.onAddressChange = function (_ref4) {\n      var value = _ref4.value;\n\n      _this.setState({\n        event: _objectSpread({}, _this.state.event, {\n          address_id: value\n        })\n      });\n    };\n\n    _this.onSeatsChange = function (_ref5) {\n      var value = _ref5.value;\n\n      _this.setState({\n        event: _objectSpread({}, _this.state.event, {\n          seats: value\n        })\n      });\n    };\n\n    _this.onDishAdd = function () {\n      var _this$state$event$sel = _this.state.event.selectedDish,\n          id = _this$state$event$sel.id,\n          products = _this$state$event$sel.products,\n          size_id = _this$state$event$sel.size_id,\n          sizes = _this$state$event$sel.sizes;\n\n      if (id) {\n        var dishes = _this.state.event.dishes;\n\n        var changedDishes = _this.increaseProperty(dishes, id, \"count\");\n\n        if (changedDishes) {\n          _this.setState({\n            event: _objectSpread({}, _this.state.event, {\n              dishes: changedDishes\n            })\n          });\n        } else {\n          var newDish = {\n            id: id,\n            name: dishIdToName(id),\n            products: products,\n            sizes: sizes,\n            size_id: size_id,\n            count: 1\n          };\n\n          _this.setState({\n            event: _objectSpread({}, _this.state.event, {\n              dishes: _toConsumableArray(_this.state.event.dishes).concat([newDish])\n            })\n          });\n        }\n      }\n    };\n\n    _this.onDishUp = function (dish_id) {\n      var dishes = _this.state.event.dishes;\n\n      var changedDishes = _this.increaseProperty(dishes, dish_id, \"count\");\n\n      _this.setState({\n        event: _objectSpread({}, _this.state.event, {\n          dishes: changedDishes\n        })\n      });\n    };\n\n    _this.onDishDown = function (dish_id) {\n      var dishes = _this.state.event.dishes;\n      var dish = dishes.find(function (dish) {\n        return dish.id === dish_id;\n      }); //before was this.onDishDelete(dish_id);\n\n      if (dish.count === 1) ;else {\n        var changedDishes = _this.decreseProperty(dishes, dish_id, \"count\");\n\n        _this.setState({\n          event: _objectSpread({}, _this.state.event, {\n            dishes: changedDishes\n          })\n        });\n      }\n    };\n\n    _this.onDishDelete = function (dish_id) {\n      var dishes = _this.state.event.dishes;\n      var idx = dishes.findIndex(function (dish) {\n        return dish.id === dish_id;\n      });\n\n      var changedDishes = _toConsumableArray(dishes.slice(0, idx)).concat(_toConsumableArray(dishes.slice(idx + 1)));\n\n      _this.setState({\n        event: _objectSpread({}, _this.state.event, {\n          dishes: changedDishes\n        })\n      });\n    };\n\n    _this.onDishClick = function (dish_id) {\n      var dishes = _this.state.event.dishes;\n      var idx = dishes.findIndex(function (dish) {\n        return dish.id === dish_id;\n      });\n\n      _this.setState({\n        event: _objectSpread({}, _this.state.event, {\n          selectedDish: dishes[idx]\n        }),\n        editMode: true\n      });\n    };\n\n    _this.onDishEditSave = function () {\n      var _this$state$event = _this.state.event,\n          selectedDish = _this$state$event.selectedDish,\n          dishes = _this$state$event.dishes;\n      var id = selectedDish.id,\n          products = selectedDish.products,\n          size_id = selectedDish.size_id;\n\n      var changedDishes = _this.updateItem(dishes, id, selectedDish, {\n        products: products,\n        size_id: size_id\n      });\n\n      _this.setState({\n        event: _objectSpread({}, _this.state.event, {\n          dishes: changedDishes,\n          selectedDish: undefined\n        }),\n        editMode: false\n      });\n    };\n\n    _this.onDishEditCancel = function () {\n      _this.setState({\n        event: _objectSpread({}, _this.state.event, {\n          selectedDish: undefined\n        }),\n        editMode: false\n      });\n    };\n\n    _this.handleClickOpen = function () {\n      _this.setState({\n        open: true\n      });\n    };\n\n    _this.handleClose = function () {\n      _this.setState({\n        open: false\n      });\n    };\n\n    _this.handleApply = function () {\n      _this.props.handleApply(_this.state.event);\n\n      _this.setState({\n        open: false\n      });\n    };\n\n    _this.handleDelete = function () {\n      _this.props.handleDelete(_this.state.event);\n\n      _this.setState({\n        open: false\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(ScheduleDialog, [{\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      if (nextProps.dialogOpen !== this.state.open) {\n        this.setState({\n          open: nextProps.dialogOpen,\n          event: nextProps.event,\n          editMode: false\n        });\n      }\n    }\n  }, {\n    key: \"comparePropeties\",\n    value: function comparePropeties(oldObj, newObj, properties) {\n      var idx = properties.findIndex(function (propName) {\n        return oldObj[propName] !== newObj[propName];\n      });\n      return idx === -1 ? true : false;\n    }\n  }, {\n    key: \"compareDishes\",\n    value: function compareDishes(oldDish, newDish) {\n      if (this.comparePropeties(oldDish, newDish, [\"size_id\"]) && this.comparePropeties(oldDish.products, newDish.products, [\"checked\"])) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n  }, {\n    key: \"upDownProperty\",\n    value: function upDownProperty(arr, id, propName, upDown) {\n      var idx = arr.findIndex(function (el) {\n        return el.id === id;\n      });\n      if (idx === -1) return;\n      var oldItem = arr[idx];\n\n      var newItem = _objectSpread({}, oldItem, _defineProperty({}, propName, upDown ? ++oldItem[propName] : --oldItem[propName]));\n\n      return _toConsumableArray(arr.slice(0, idx)).concat([newItem], _toConsumableArray(arr.slice(idx + 1)));\n    }\n  }, {\n    key: \"toggleProperty\",\n    value: function toggleProperty(arr, id, propName) {\n      var idx = arr.findIndex(function (el) {\n        return el.value === id;\n      });\n      var oldItem = arr[idx];\n\n      var newItem = _objectSpread({}, oldItem, _defineProperty({}, propName, !oldItem[propName]));\n\n      return _toConsumableArray(arr.slice(0, idx)).concat([newItem], _toConsumableArray(arr.slice(idx + 1)));\n    }\n  }, {\n    key: \"updateItem\",\n    value: function updateItem(arr, id, item, props) {\n      var idx = arr.findIndex(function (el) {\n        return el.id === id;\n      });\n      var newItem = props ? _objectSpread({}, arr[idx], props) : item;\n      return _toConsumableArray(arr.slice(0, idx)).concat([newItem], _toConsumableArray(arr.slice(idx + 1)));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      console.log(\"rendering... State=\", this.state);\n      var _this$state = this.state,\n          editMode = _this$state.editMode,\n          event = _this$state.event;\n      var restaurant_id = event.restaurant_id,\n          category_id = event.category_id,\n          selectedDish = event.selectedDish,\n          start = event.start,\n          dishes = event.dishes,\n          location_id = event.location_id,\n          address_id = event.address_id,\n          seats = event.seats;\n      var location = location_id ? location_id : \"1\";\n\n      var SelectRestaurant = function SelectRestaurant() {\n        return !editMode && React.createElement(SelectControl, {\n          onSelectChange: _this2.onRestaurantChange,\n          name: \"title\",\n          value: restaurant_id,\n          items: restaurantsSelectItems,\n          emptyValue: \"Select restaurant\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 291\n          },\n          __self: this\n        });\n      };\n\n      var SelectCategory = function SelectCategory() {\n        return !editMode && React.createElement(SelectControl, {\n          onSelectChange: _this2.onDishCategoryChange,\n          name: \"category\",\n          value: category_id,\n          items: dishCategoriesSelectItems(restaurant_id),\n          emptyValue: \"Select category\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 300\n          },\n          __self: this\n        });\n      };\n\n      var SelectDish = function SelectDish() {\n        return !editMode && React.createElement(SelectControl, {\n          onSelectChange: _this2.onDishChange,\n          name: \"dish\",\n          value: selectedDish ? selectedDish.id : 0,\n          items: dishesSelectItems(category_id),\n          emptyValue: \"Select dish\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 309\n          },\n          __self: this\n        });\n      };\n\n      var SelectLocation = function SelectLocation() {\n        return dishes.length > 0 && !editMode && React.createElement(RadioSelect, {\n          items: _this2.deliveryLocations,\n          selected: location_id,\n          onChange: _this2.onLocationChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 318\n          },\n          __self: this\n        });\n      };\n\n      var SelectSeats = function SelectSeats() {\n        return location === \"1\" && !editMode && dishes.length > 0 && React.createElement(SelectControl, {\n          onSelectChange: _this2.onSeatsChange,\n          name: \"seats\",\n          items: seatsSelectItems,\n          value: seats,\n          emptyValue: \"Select seats number\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 325\n          },\n          __self: this\n        });\n      };\n\n      var SelectAddress = function SelectAddress() {\n        return location === \"2\" && !editMode && dishes.length > 0 && React.createElement(SelectControl, {\n          onSelectChange: _this2.onAddressChange,\n          name: \"title\",\n          value: address_id,\n          items: addressesSelectItems,\n          emptyValue: \"Select address\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 332\n          },\n          __self: this\n        });\n      };\n\n      var DishProducts = function DishProducts() {\n        return selectedDish !== undefined && React.createElement(ProductsList, {\n          items: selectedDish.products,\n          onProductChange: _this2.onProductChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 341\n          },\n          __self: this\n        });\n      };\n\n      var DishSizes = function DishSizes() {\n        return selectedDish !== undefined && React.createElement(RadioSelect, {\n          items: selectedDish.sizes,\n          selected: selectedDish.size_id,\n          onChange: _this2.onDishSizeChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 347\n          },\n          __self: this\n        });\n      };\n\n      var ButtonAdd = function ButtonAdd() {\n        return !editMode && React.createElement(Button, {\n          onClick: _this2.onDishAdd,\n          disabled: !(restaurant_id && category_id && selectedDish),\n          color: \"secondary\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 354\n          },\n          __self: this\n        }, \"Add\");\n      };\n\n      var ButtonEditSave = function ButtonEditSave() {\n        return editMode && React.createElement(Button, {\n          onClick: _this2.onDishEditSave,\n          color: \"secondary\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 363\n          },\n          __self: this\n        }, \"Save\");\n      };\n\n      var ButtonEditCancel = function ButtonEditCancel() {\n        return editMode && React.createElement(Button, {\n          onClick: _this2.onDishEditCancel,\n          color: \"primary\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 368\n          },\n          __self: this\n        }, \"Cancel\");\n      };\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 373\n        },\n        __self: this\n      }, React.createElement(Dialog, {\n        open: this.state.open,\n        onClose: this.handleClose,\n        \"aria-labelledby\": \"form-dialog-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 374\n        },\n        __self: this\n      }, React.createElement(DialogTitle, {\n        id: \"form-dialog-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 379\n        },\n        __self: this\n      }, start ? start.toLocaleString() : \"Schedule Item\"), React.createElement(DialogContent, {\n        className: \"schedule-item\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 383\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"selects\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 384\n        },\n        __self: this\n      }, React.createElement(SelectRestaurant, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 385\n        },\n        __self: this\n      }), React.createElement(SelectCategory, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 386\n        },\n        __self: this\n      }), React.createElement(SelectDish, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 387\n        },\n        __self: this\n      }), React.createElement(DishProducts, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 388\n        },\n        __self: this\n      }), React.createElement(DishSizes, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 389\n        },\n        __self: this\n      }), React.createElement(ButtonAdd, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 390\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row-elements\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 391\n        },\n        __self: this\n      }, React.createElement(ButtonEditCancel, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 392\n        },\n        __self: this\n      }), React.createElement(ButtonEditSave, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 393\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"column-elements\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 396\n        },\n        __self: this\n      }, React.createElement(DishesList, {\n        items: dishes,\n        onDishUp: this.onDishUp,\n        onDishDown: this.onDishDown,\n        onDishDelete: this.onDishDelete,\n        onDishClick: this.onDishClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 397\n        },\n        __self: this\n      }), React.createElement(SelectLocation, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 404\n        },\n        __self: this\n      }), React.createElement(SelectAddress, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 405\n        },\n        __self: this\n      }), React.createElement(SelectSeats, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 406\n        },\n        __self: this\n      }))), React.createElement(DialogActions, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 410\n        },\n        __self: this\n      }, React.createElement(Button, {\n        onClick: this.handleDelete,\n        color: \"secondary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 411\n        },\n        __self: this\n      }, React.createElement(DeleteIcon, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 412\n        },\n        __self: this\n      })), React.createElement(Button, {\n        onClick: this.handleClose,\n        color: \"primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 414\n        },\n        __self: this\n      }, \"Close\"), React.createElement(Button, {\n        onClick: this.handleApply,\n        color: \"primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 417\n        },\n        __self: this\n      }, \"Apply changes\"))));\n    }\n  }]);\n\n  return ScheduleDialog;\n}(React.Component);\n\nexport { ScheduleDialog as default };","map":{"version":3,"sources":["D:\\Studia\\React\\I3IV\\Dyplom\\src\\node_modules\\components\\schedule-dialog\\index.js"],"names":["React","Button","Dialog","DialogActions","DialogTitle","DialogContent","SelectControl","DishesList","ProductsList","RadioSelect","DeleteIcon","restaurantsSelectItems","dishCategoriesSelectItems","dishesSelectItems","productsSelectItems","dishSizesSelectItems","addressesSelectItems","restaurantIdToName","seatsSelectItems","dishIdToName","ScheduleDialog","state","open","event","dishes","editMode","deliveryLocations","id","name","increaseProperty","arr","propName","upDownProperty","decreseProperty","onRestaurantChange","value","setState","title","restaurant_id","category_id","selectedDish","undefined","onDishCategoryChange","onDishChange","newSelectedDish","products","map","product","checked","sizes","size_id","onProductChange","product_id","changedProducts","toggleProperty","onDishSizeChange","onLocationChange","location_id","onAddressChange","address_id","onSeatsChange","seats","onDishAdd","changedDishes","newDish","count","onDishUp","dish_id","onDishDown","dish","find","onDishDelete","idx","findIndex","slice","onDishClick","onDishEditSave","updateItem","onDishEditCancel","handleClickOpen","handleClose","handleApply","props","handleDelete","nextProps","dialogOpen","oldObj","newObj","properties","oldDish","comparePropeties","upDown","el","oldItem","newItem","item","console","log","start","location","SelectRestaurant","SelectCategory","SelectDish","SelectLocation","length","SelectSeats","SelectAddress","DishProducts","DishSizes","ButtonAdd","ButtonEditSave","ButtonEditCancel","toLocaleString","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport SelectControl from \"components/select-control\";\r\nimport DishesList from \"components/schedule-item-dishes-list\";\r\nimport ProductsList from \"components/schedule-item-products-list\";\r\nimport RadioSelect from 'components/radio-select';\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport \"./schedule-dialog.css\";\r\nimport {\r\n  restaurantsSelectItems,\r\n  dishCategoriesSelectItems,\r\n  dishesSelectItems,\r\n  productsSelectItems,\r\n  dishSizesSelectItems,\r\n  addressesSelectItems,\r\n  restaurantIdToName,\r\n  seatsSelectItems,\r\n  dishIdToName\r\n} from \"api\";\r\nexport default class ScheduleDialog extends React.Component {\r\n  state = {\r\n    open: false,\r\n    event: { dishes: [] },\r\n    editMode: false\r\n  };\r\n  deliveryLocations = [\r\n    {id:1, name:'In restaurant'},\r\n    {id:2, name:'Deliver to address'},\r\n  ];\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    if (nextProps.dialogOpen !== this.state.open) {\r\n      this.setState({\r\n        open: nextProps.dialogOpen,\r\n        event: nextProps.event,\r\n        editMode: false\r\n      });\r\n    }\r\n  }\r\n\r\n  comparePropeties(oldObj, newObj, properties) {\r\n    const idx = properties.findIndex(propName => {\r\n      return oldObj[propName] !== newObj[propName];\r\n    });\r\n    return idx === -1 ? true : false;\r\n  }\r\n  compareDishes(oldDish, newDish) {\r\n    if (\r\n      this.comparePropeties(oldDish, newDish, [\"size_id\"]) &&\r\n      this.comparePropeties(oldDish.products, newDish.products, [\"checked\"])\r\n    ) {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  upDownProperty(arr, id, propName, upDown) {\r\n    const idx = arr.findIndex(el => el.id === id);\r\n    if (idx === -1) return;\r\n\r\n    const oldItem = arr[idx];\r\n\r\n    const newItem = {\r\n      ...oldItem,\r\n      [propName]: upDown ? ++oldItem[propName] : --oldItem[propName]\r\n    };\r\n    return [...arr.slice(0, idx), newItem, ...arr.slice(idx + 1)];\r\n  }\r\n  toggleProperty(arr, id, propName) {\r\n    const idx = arr.findIndex(el => el.value === id);\r\n    const oldItem = arr[idx];\r\n    const newItem = { ...oldItem, [propName]: !oldItem[propName] };\r\n\r\n    return [...arr.slice(0, idx), newItem, ...arr.slice(idx + 1)];\r\n  }\r\n  updateItem(arr, id, item, props) {\r\n    const idx = arr.findIndex(el => el.id === id);\r\n    const newItem = props ? { ...arr[idx], ...props } : item;\r\n    return [...arr.slice(0, idx), newItem, ...arr.slice(idx + 1)];\r\n  }\r\n\r\n  increaseProperty = (arr, id, propName) =>\r\n    this.upDownProperty(arr, id, propName, true);\r\n  decreseProperty = (arr, id, propName) =>\r\n    this.upDownProperty(arr, id, propName, false);\r\n\r\n  onRestaurantChange = ({ value }) => {\r\n    this.setState({\r\n      event: {\r\n        ...this.state.event,\r\n        title: restaurantIdToName(value),\r\n        restaurant_id: value,\r\n        category_id: 0,\r\n        selectedDish: undefined\r\n      }\r\n    });\r\n  };\r\n  onDishCategoryChange = ({ value }) => {\r\n    this.setState({\r\n      event: {\r\n        ...this.state.event,\r\n        category_id: value,\r\n        selectedDish: undefined\r\n      }\r\n    });\r\n  };\r\n  onDishChange = ({ value }) => {\r\n    const newSelectedDish = value\r\n      ? {\r\n          id: value,\r\n          products: productsSelectItems(value).map(product => ({\r\n            ...product,\r\n            checked: true\r\n          })),\r\n          sizes: dishSizesSelectItems(value),\r\n          size_id: dishSizesSelectItems(value)[0].id\r\n        }\r\n      : undefined;\r\n    this.setState({\r\n      event: { ...this.state.event, selectedDish: newSelectedDish }\r\n    });\r\n  };\r\n  onProductChange = product_id => {\r\n    const { products } = this.state.event.selectedDish;\r\n    const changedProducts = this.toggleProperty(\r\n      products,\r\n      product_id,\r\n      \"checked\"\r\n    );\r\n    this.setState({\r\n      event: {\r\n        ...this.state.event,\r\n        selectedDish: {\r\n          ...this.state.event.selectedDish,\r\n          products: changedProducts\r\n        }\r\n      }\r\n    });\r\n  };\r\n  onDishSizeChange = size_id => {\r\n    this.setState({\r\n      event: {\r\n        ...this.state.event,\r\n        selectedDish: { ...this.state.event.selectedDish, size_id }\r\n      }\r\n    });\r\n  };\r\n  onLocationChange = (location_id) => {\r\n    this.setState({\r\n      event: { ...this.state.event, location_id: location_id },\r\n    });\r\n  }\r\n  onAddressChange = ({value}) => {\r\n    this.setState({\r\n      event: { ...this.state.event, address_id: value },\r\n    });\r\n  }\r\n  onSeatsChange = ({value}) => {\r\n    this.setState({\r\n      event: { ...this.state.event, seats: value },\r\n    });\r\n  }\r\n\r\n  onDishAdd = () => {\r\n    const { id, products, size_id, sizes } = this.state.event.selectedDish;\r\n\r\n    if (id) {\r\n      const dishes = this.state.event.dishes;\r\n      const changedDishes = this.increaseProperty(dishes, id, \"count\");\r\n\r\n      if (changedDishes) {\r\n        this.setState({\r\n          event: { ...this.state.event, dishes: changedDishes }\r\n        });\r\n      } else {\r\n        const newDish = {\r\n          id,\r\n          name: dishIdToName(id),\r\n          products: products,\r\n          sizes,\r\n          size_id,\r\n          count: 1\r\n        };\r\n        this.setState({\r\n          event: {\r\n            ...this.state.event,\r\n            dishes: [...this.state.event.dishes, newDish]\r\n          }\r\n        });\r\n      }\r\n    }\r\n  };\r\n  onDishUp = dish_id => {\r\n    const dishes = this.state.event.dishes;\r\n    const changedDishes = this.increaseProperty(dishes, dish_id, \"count\");\r\n\r\n    this.setState({\r\n      event: { ...this.state.event, dishes: changedDishes }\r\n    });\r\n  };\r\n  onDishDown = dish_id => {\r\n    const dishes = this.state.event.dishes;\r\n    const dish = dishes.find(dish => dish.id === dish_id);\r\n    //before was this.onDishDelete(dish_id);\r\n    if (dish.count === 1) ;\r\n    else {\r\n      const changedDishes = this.decreseProperty(dishes, dish_id, \"count\");\r\n\r\n      this.setState({\r\n        event: { ...this.state.event, dishes: changedDishes }\r\n      });\r\n    }\r\n  };\r\n  onDishDelete = dish_id => {\r\n    const dishes = this.state.event.dishes;\r\n    const idx = dishes.findIndex(dish => dish.id === dish_id);\r\n    const changedDishes = [...dishes.slice(0, idx), ...dishes.slice(idx + 1)];\r\n    this.setState({\r\n      event: { ...this.state.event, dishes: changedDishes }\r\n    });\r\n  };\r\n  onDishClick = dish_id => {\r\n    const dishes = this.state.event.dishes;\r\n    const idx = dishes.findIndex(dish => dish.id === dish_id);\r\n    this.setState({\r\n      event: { ...this.state.event, selectedDish: dishes[idx] },\r\n      editMode: true\r\n    });\r\n  };\r\n  onDishEditSave = () => {\r\n    const { selectedDish, dishes } = this.state.event;\r\n    const { id, products, size_id } = selectedDish;\r\n    const changedDishes = this.updateItem(dishes, id, selectedDish, {\r\n      products,\r\n      size_id\r\n    });\r\n    this.setState({\r\n      event: {\r\n        ...this.state.event,\r\n        dishes: changedDishes,\r\n        selectedDish: undefined\r\n      },\r\n      editMode: false\r\n    });\r\n  };\r\n  onDishEditCancel = () => {\r\n    this.setState({\r\n      event: { ...this.state.event, selectedDish: undefined },\r\n      editMode: false\r\n    });\r\n  };\r\n\r\n  handleClickOpen = () => {\r\n    this.setState({ open: true });\r\n  };\r\n  handleClose = () => {\r\n    this.setState({ open: false });\r\n  };\r\n  handleApply = () => {\r\n    this.props.handleApply(this.state.event);\r\n    this.setState({ open: false });\r\n  };\r\n  handleDelete = () => {\r\n    this.props.handleDelete(this.state.event);\r\n    this.setState({ open: false });\r\n  };\r\n\r\n  render() {\r\n    console.log(\"rendering... State=\", this.state);\r\n    const { editMode, event } = this.state;\r\n    const {\r\n      restaurant_id,\r\n      category_id,\r\n      selectedDish,\r\n      start,\r\n      dishes,\r\n      location_id,\r\n      address_id,\r\n      seats\r\n    } = event;\r\n\r\n    const location = location_id ? location_id : \"1\";\r\n\r\n    const SelectRestaurant = () =>\r\n      !editMode &&\r\n      <SelectControl\r\n        onSelectChange={this.onRestaurantChange}\r\n        name=\"title\"\r\n        value={restaurant_id}\r\n        items={restaurantsSelectItems}\r\n        emptyValue=\"Select restaurant\"\r\n      />\r\n    const SelectCategory = () =>\r\n      !editMode &&\r\n      <SelectControl\r\n        onSelectChange={this.onDishCategoryChange}\r\n        name=\"category\"\r\n        value={category_id}\r\n        items={dishCategoriesSelectItems(restaurant_id)}\r\n        emptyValue=\"Select category\"\r\n      />\r\n    const SelectDish = () =>\r\n      !editMode &&\r\n      <SelectControl\r\n        onSelectChange={this.onDishChange}\r\n        name=\"dish\"\r\n        value={selectedDish ? selectedDish.id : 0}\r\n        items={dishesSelectItems(category_id)}\r\n        emptyValue=\"Select dish\"\r\n      />\r\n    const SelectLocation = () =>\r\n      dishes.length > 0 && !editMode &&\r\n      <RadioSelect\r\n        items={this.deliveryLocations}\r\n        selected={location_id}\r\n        onChange={this.onLocationChange}\r\n      />\r\n    const SelectSeats = () =>\r\n     location === \"1\" && !editMode && dishes.length > 0 &&\r\n     <SelectControl onSelectChange={this.onSeatsChange}\r\n                    name = 'seats'\r\n                    items = {seatsSelectItems}\r\n                    value = {seats}\r\n                    emptyValue = 'Select seats number'/>\r\n    const SelectAddress = () =>\r\n      location === \"2\" && !editMode && dishes.length > 0 &&\r\n      <SelectControl\r\n            onSelectChange={this.onAddressChange}\r\n            name=\"title\"\r\n            value={address_id}\r\n            items={addressesSelectItems}\r\n            emptyValue=\"Select address\"\r\n       />\r\n    const DishProducts = () =>\r\n     selectedDish !== undefined &&\r\n     <ProductsList\r\n      items={selectedDish.products}\r\n      onProductChange={this.onProductChange}\r\n     />\r\n    const DishSizes = () =>\r\n     selectedDish !== undefined &&\r\n      <RadioSelect\r\n        items={selectedDish.sizes}\r\n        selected={selectedDish.size_id}\r\n        onChange={this.onDishSizeChange}\r\n      />\r\n    const ButtonAdd = () =>\r\n      !editMode &&\r\n      <Button\r\n        onClick={this.onDishAdd}\r\n        disabled={!(restaurant_id && category_id && selectedDish)}\r\n        color=\"secondary\"\r\n      >\r\n        Add\r\n      </Button>\r\n    const ButtonEditSave = () =>\r\n      editMode &&\r\n      <Button onClick={this.onDishEditSave} color=\"secondary\">\r\n        Save\r\n      </Button>\r\n    const ButtonEditCancel = () =>\r\n      editMode &&\r\n      <Button onClick={this.onDishEditCancel} color=\"primary\">\r\n        Cancel\r\n      </Button>\r\n\r\n    return (\r\n      <div>\r\n        <Dialog\r\n          open={this.state.open}\r\n          onClose={this.handleClose}\r\n          aria-labelledby=\"form-dialog-title\"\r\n        >\r\n          <DialogTitle id=\"form-dialog-title\">\r\n            {start ? start.toLocaleString() : `Schedule Item`}\r\n          </DialogTitle>\r\n\r\n          <DialogContent className=\"schedule-item\">\r\n            <div className=\"selects\">\r\n              <SelectRestaurant />\r\n              <SelectCategory />\r\n              <SelectDish />\r\n              <DishProducts />\r\n              <DishSizes />\r\n              <ButtonAdd />\r\n              <div className=\"row-elements\">\r\n                <ButtonEditCancel />\r\n                <ButtonEditSave />\r\n              </div>\r\n            </div>\r\n            <div className=\"column-elements\">\r\n              <DishesList\r\n                items={dishes}\r\n                onDishUp={this.onDishUp}\r\n                onDishDown={this.onDishDown}\r\n                onDishDelete={this.onDishDelete}\r\n                onDishClick={this.onDishClick}\r\n              />\r\n              <SelectLocation />\r\n              <SelectAddress />\r\n              <SelectSeats />\r\n            </div>\r\n          </DialogContent>\r\n\r\n          <DialogActions>\r\n            <Button onClick={this.handleDelete} color=\"secondary\">\r\n              <DeleteIcon />\r\n            </Button>\r\n            <Button onClick={this.handleClose} color=\"primary\">\r\n              Close\r\n            </Button>\r\n            <Button onClick={this.handleApply} color=\"primary\">\r\n              Apply changes\r\n            </Button>\r\n          </DialogActions>\r\n\r\n        </Dialog>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}